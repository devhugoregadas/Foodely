"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[3411],{3411:(oe,v,l)=>{l.r(v),l.d(v,{AddRestaurantPageModule:()=>K});var Z=l(9808),d=l(4182),o=l(7110),T=l(1143),g=l(655),y=l(7123);class x{constructor(a,i,n,c,s,r,u,m,p,h,_,A,f,W,$,X,V,ee,te,ie,ne){this.uid=a,this.cover=i,this.name=n,this.short_name=c,this.cuisines=s,this.rating=r,this.delivery_time=u,this.price=m,this.phone=p,this.email=h,this.isClose=_,this.description=A,this.openTime=f,this.closeTime=W,this.city=$,this.address=X,this.status=V,this.totalRating=ee,this.coordinates=te,this.g=ie,this.distance=ne}}var e=l(9863),M=l(1228),P=l(5593),R=l(7020),q=l(3587),b=l(162);function U(t,a){1&t&&(e.TgZ(0,"ion-text",51)(1,"p",52),e._uU(2,"* Please enter your name"),e.qZA()())}function C(t,a){1&t&&(e.TgZ(0,"ion-text",51)(1,"p",52),e._uU(2,"* Please enter a valid email address"),e.qZA()())}function I(t,a){1&t&&(e.TgZ(0,"ion-text",51)(1,"p",52),e._uU(2,"* Please enter a valid phone number"),e.qZA()())}function J(t,a){1&t&&(e.TgZ(0,"ion-text",53)(1,"p",52),e._uU(2,"* Password must be of minimum 8 characters long."),e.qZA()())}function S(t,a){1&t&&(e.TgZ(0,"ion-text",51)(1,"p",52),e._uU(2,"* Please enter your name"),e.qZA()())}function N(t,a){1&t&&(e.TgZ(0,"ion-text",53)(1,"p",52),e._uU(2,"* Select Opening Time."),e.qZA()())}function Q(t,a){1&t&&(e.TgZ(0,"ion-text",53)(1,"p",52),e._uU(2,"* Select Closing Time."),e.qZA()())}function Y(t,a){if(1&t&&(e.TgZ(0,"ion-select-option",54),e._uU(1),e.qZA()),2&t){const i=a.$implicit;e.Q6J("value",i.uid),e.xp6(1),e.Oqu(null==i?null:i.name)}}function w(t,a){1&t&&(e.TgZ(0,"ion-text",53)(1,"p",52),e._uU(2,"* Select City."),e.qZA()())}function L(t,a){if(1&t&&(e.TgZ(0,"p",55),e._uU(1),e.qZA()),2&t){const i=e.oxw();e.xp6(1),e.Oqu(null==i.location?null:i.location.address)}}function O(t,a){1&t&&(e.TgZ(0,"ion-text",51)(1,"p",52),e._uU(2,"* Please enter price for two persons"),e.qZA()())}function F(t,a){1&t&&(e.TgZ(0,"ion-text",51)(1,"p",52),e._uU(2,"* Please enter Expected Delivery Time"),e.qZA()())}function D(t,a){if(1&t&&e._UZ(0,"img",56),2&t){const i=e.oxw();e.Q6J("src",i.coverImage,e.LSH)}}function G(t,a){if(1&t&&(e.TgZ(0,"p"),e._uU(1),e.qZA()),2&t){const i=e.oxw();e.xp6(1),e.hij("Categories: ",i.getArrayAsString(i.categories),"")}}function j(t,a){if(1&t&&(e.TgZ(0,"p"),e._uU(1),e.qZA()),2&t){const i=e.oxw();e.xp6(1),e.hij("Cuisines: ",i.getArrayAsString(i.cuisines),"")}}function z(t,a){if(1&t&&(e.TgZ(0,"ion-button",57),e._uU(1," Save "),e.qZA()),2&t){e.oxw();const i=e.MAs(8);e.Q6J("disabled",!i.valid)}}function E(t,a){if(1&t&&(e.TgZ(0,"div",58)(1,"ion-button",59),e._UZ(2,"ion-spinner",60),e.qZA()()),2&t){e.oxw();const i=e.MAs(8);e.xp6(1),e.Q6J("disabled",!i.valid)}}const k=[{path:"",component:(()=>{class t{constructor(i,n,c,s,r){this.authService=i,this.apiService=n,this.global=c,this.restaurantService=s,this.categoryService=r,this.isLoading=!1,this.cities=[],this.location={},this.isCuisine=!1,this.cuisines=[],this.categories=[]}ngOnInit(){this.getCities()}getCities(){return(0,g.mG)(this,void 0,void 0,function*(){try{this.cities=yield this.apiService.getCities()}catch(i){console.log(i),this.global.errorToast()}})}searchLocation(){return(0,g.mG)(this,void 0,void 0,function*(){try{const i={component:y.t},n=yield this.global.createModal(i);n&&(console.log(n),this.location=n)}catch(i){console.log(i)}})}addCategory(){console.log(this.category),""!=this.category.trim()&&(console.log(this.isCuisine),this.categories.find(n=>n==this.category)?this.global.errorToast("Category already added"):(this.categories.push(this.category),this.isCuisine&&this.cuisines.push(this.category)))}clearCategory(){this.categories=[],this.cuisines=[]}getArrayAsString(i){return i.join(", ")}preview(i){return(0,g.mG)(this,void 0,void 0,function*(){console.log(i);const n=i.target.files;if(0==n.length||null==n[0].type.match(/image\/*/))return;const s=n[0],r="restaurants/"+Date.now()+"_"+s.name;try{const u=yield this.apiService.uploadImage(s,r);this.coverImage=u}catch(u){console.log(u),this.global.errorToast("Image upload failed")}})}onSubmit(i){var n;if(i.valid){if(!this.coverImage||""==this.coverImage)return void this.global.errorToast("Please select a cover image");this.location&&(null===(n=this.location)||void 0===n?void 0:n.lat)?this.addRestaurant(i):this.global.errorToast("Please select address for this restaurant")}}addRestaurant(i){return(0,g.mG)(this,void 0,void 0,function*(){try{this.isLoading=!0,console.log(i.value);const n=yield this.authService.createUser(i.value,"restaurant");if(null==n?void 0:n.id){const c=this.apiService.getGeoPoint(this.location.lat,this.location.lng),s=new x(n.id,this.coverImage?this.coverImage:"",i.value.res_name,i.value.res_name.toLowerCase(),this.cuisines,0,i.value.delivery_time,i.value.price,i.value.phone,i.value.email,!1,i.value.description,i.value.openTime,i.value.closeTime,i.value.city,this.location.address,"active",0,c),r=yield this.restaurantService.addRestaurant(s,n.id);console.log(r),yield this.categoryService.addCategories(this.categories,n.id),this.global.successToast("Restaurant Added Successfully")}else this.global.showAlert("Restaurant Registration failed");this.isLoading=!1}catch(n){console.log(n),this.isLoading=!1;let c="Could not register the restaurant, please try again.";"auth/email-already-in-use"==n.code&&(c=n.message),this.global.showAlert(c)}})}}return t.\u0275fac=function(i){return new(i||t)(e.Y36(M.e),e.Y36(P.s),e.Y36(R.U),e.Y36(q.T),e.Y36(b.H))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-add-restaurant"]],decls:97,vars:19,consts:[["color","primary"],["slot","start"],["defaultHref","/admin"],[1,"ion-padding"],[3,"ngSubmit"],["f1","ngForm"],["lines","none"],["color","light",1,"ion-margin-bottom"],["name","person","slot","start","color","primary"],["type","text","name","name","ngModel","","placeholder","Name","required",""],["name","ngModel"],["color","danger",4,"ngIf"],["name","mail","slot","start","color","primary"],["type","email","name","email","ngModel","","email","","placeholder","Email","required",""],["emailCtrl","ngModel"],["name","call","slot","start","color","primary"],["type","tel","name","phone","ngModel","","placeholder","Phone","required","","minlength","10","maxlength","10"],["phone","ngModel"],["name","key","slot","start","color","primary"],["type","password","name","password","ngModel","","placeholder","Password","required","","minlength","8"],["passwordCtrl","ngModel"],["color","danger","class","ion-text-center",4,"ngIf"],["type","text","name","res_name","ngModel","","placeholder","Restaurant Name","required",""],["res_name","ngModel"],["type","text","name","description","ngModel","","placeholder","Description"],["description","ngModel"],["displayFormat","hh:mm A","name","openTime","ngModel","","required","","presentation","time"],["openTime","ngModel"],["displayFormat","hh:mm A","name","closeTime","ngModel","","required","","presentation","time"],["closeTime","ngModel"],["name","city","ngModel","","required",""],["city","ngModel"],[3,"value",4,"ngFor","ngForOf"],[1,"ion-margin-bottom"],["class","ion-text-wrap",4,"ngIf"],["color","primary","size","small",3,"click"],["name","cash-outline","slot","start","color","primary"],["type","number","name","price","ngModel","","placeholder","Price for Two","required",""],["price","ngModel"],["name","time-outline","slot","start","color","primary"],["type","number","name","delivery_time","ngModel","","placeholder","Expected Delivery Time","required",""],["delivery_time","ngModel"],["type","file",3,"change"],[3,"src",4,"ngIf"],["name","category","placeholder","Enter New Category","type","text",3,"ngModel","ngModelChange"],["mode","md","color","success","name","isCuisine",3,"ngModel","ngModelChange"],["type","button","size","small","color","primary",3,"click"],["type","button","size","small","color","danger",3,"click"],[4,"ngIf"],["expand","block","shape","round","type","submit","color","primary",3,"disabled",4,"ngIf"],["class","ion-text-center",4,"ngIf"],["color","danger"],[1,"errorMsg"],["color","danger",1,"ion-text-center"],[3,"value"],[1,"ion-text-wrap"],[3,"src"],["expand","block","shape","round","type","submit","color","primary",3,"disabled"],[1,"ion-text-center"],["shape","round","color","primary",3,"disabled"],["name","circles"]],template:function(i,n){if(1&i){const c=e.EpF();e.TgZ(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-buttons",1),e._UZ(3,"ion-back-button",2),e.qZA(),e.TgZ(4,"ion-title"),e._uU(5,"Add Restaurant"),e.qZA()()(),e.TgZ(6,"ion-content",3)(7,"form",4,5),e.NdJ("ngSubmit",function(){e.CHM(c);const r=e.MAs(8);return n.onSubmit(r)}),e.TgZ(9,"ion-list",6)(10,"ion-list-header")(11,"ion-label"),e._uU(12,"Owner Details"),e.qZA()(),e.TgZ(13,"ion-item",7),e._UZ(14,"ion-icon",8)(15,"ion-input",9,10),e.qZA(),e.YNc(17,U,3,0,"ion-text",11),e.TgZ(18,"ion-item",7),e._UZ(19,"ion-icon",12)(20,"ion-input",13,14),e.qZA(),e.YNc(22,C,3,0,"ion-text",11),e.TgZ(23,"ion-item",7),e._UZ(24,"ion-icon",15)(25,"ion-input",16,17),e.qZA(),e.YNc(27,I,3,0,"ion-text",11),e.TgZ(28,"ion-item",7),e._UZ(29,"ion-icon",18)(30,"ion-input",19,20),e.qZA(),e.YNc(32,J,3,0,"ion-text",21),e.qZA(),e.TgZ(33,"ion-list",6)(34,"ion-list-header")(35,"ion-label"),e._uU(36,"Restaurant Details"),e.qZA()(),e.TgZ(37,"ion-item",7),e._UZ(38,"ion-icon",8)(39,"ion-input",22,23),e.qZA(),e.YNc(41,S,3,0,"ion-text",11),e.TgZ(42,"ion-item",7),e._UZ(43,"ion-textarea",24,25),e.qZA(),e.TgZ(45,"ion-item",7)(46,"ion-label"),e._uU(47,"Open Time"),e.qZA(),e._UZ(48,"ion-datetime",26,27),e.qZA(),e.YNc(50,N,3,0,"ion-text",21),e.TgZ(51,"ion-item",7)(52,"ion-label"),e._uU(53,"Close Time"),e.qZA(),e._UZ(54,"ion-datetime",28,29),e.qZA(),e.YNc(56,Q,3,0,"ion-text",21),e.TgZ(57,"ion-item",7)(58,"ion-label"),e._uU(59,"Select City"),e.qZA(),e.TgZ(60,"ion-select",30,31),e.YNc(62,Y,2,2,"ion-select-option",32),e.qZA()(),e.YNc(63,w,3,0,"ion-text",21),e.TgZ(64,"ion-item",33)(65,"ion-label"),e._uU(66," Address "),e.YNc(67,L,2,1,"p",34),e.qZA(),e.TgZ(68,"ion-button",35),e.NdJ("click",function(){return n.searchLocation()}),e._uU(69,"Search"),e.qZA()(),e.TgZ(70,"ion-item",7),e._UZ(71,"ion-icon",36)(72,"ion-input",37,38),e.qZA(),e.YNc(74,O,3,0,"ion-text",11),e.TgZ(75,"ion-item",7),e._UZ(76,"ion-icon",39)(77,"ion-input",40,41),e.qZA(),e.YNc(79,F,3,0,"ion-text",11),e.TgZ(80,"ion-item")(81,"h4"),e._uU(82,"Cover Image"),e.qZA(),e.TgZ(83,"input",42),e.NdJ("change",function(r){return n.preview(r)}),e.qZA(),e.TgZ(84,"p"),e.YNc(85,D,1,1,"img",43),e.qZA()(),e.TgZ(86,"ion-item")(87,"ion-input",44),e.NdJ("ngModelChange",function(r){return n.category=r}),e.qZA(),e.TgZ(88,"ion-toggle",45),e.NdJ("ngModelChange",function(r){return n.isCuisine=r}),e.qZA()(),e.TgZ(89,"ion-button",46),e.NdJ("click",function(){return n.addCategory()}),e._uU(90,"ADD"),e.qZA(),e.TgZ(91,"ion-button",47),e.NdJ("click",function(){return n.clearCategory()}),e._uU(92,"CLEAR"),e.qZA(),e.YNc(93,G,2,1,"p",48),e.YNc(94,j,2,1,"p",48),e.qZA(),e.YNc(95,z,2,1,"ion-button",49),e.YNc(96,E,3,1,"div",50),e.qZA()()}if(2&i){const c=e.MAs(16),s=e.MAs(21),r=e.MAs(26),u=e.MAs(31),m=e.MAs(40),p=e.MAs(49),h=e.MAs(55),_=e.MAs(61),A=e.MAs(73),f=e.MAs(78);e.xp6(17),e.Q6J("ngIf",!c.valid&&c.touched),e.xp6(5),e.Q6J("ngIf",!s.valid&&s.touched),e.xp6(5),e.Q6J("ngIf",!r.valid&&r.touched),e.xp6(5),e.Q6J("ngIf",!u.valid&&u.touched),e.xp6(9),e.Q6J("ngIf",!m.valid&&m.touched),e.xp6(9),e.Q6J("ngIf",!p.valid&&p.touched),e.xp6(6),e.Q6J("ngIf",!h.valid&&h.touched),e.xp6(6),e.Q6J("ngForOf",n.cities),e.xp6(1),e.Q6J("ngIf",!_.valid&&_.touched),e.xp6(4),e.Q6J("ngIf",n.location&&(null==n.location?null:n.location.lat)),e.xp6(7),e.Q6J("ngIf",!A.valid&&A.touched),e.xp6(5),e.Q6J("ngIf",!f.valid&&f.touched),e.xp6(6),e.Q6J("ngIf",n.coverImage),e.xp6(2),e.Q6J("ngModel",n.category),e.xp6(1),e.Q6J("ngModel",n.isCuisine),e.xp6(5),e.Q6J("ngIf",(null==n.categories?null:n.categories.length)>0),e.xp6(1),e.Q6J("ngIf",(null==n.cuisines?null:n.cuisines.length)>0),e.xp6(1),e.Q6J("ngIf",!n.isLoading),e.xp6(1),e.Q6J("ngIf",n.isLoading)}},directives:[o.Gu,o.sr,o.Sm,o.oU,o.cs,o.wd,o.W2,d._Y,d.JL,d.F,o.q_,o.yh,o.Q$,o.Ie,o.gu,o.pK,o.j9,d.JJ,d.On,d.Q7,Z.O5,o.yW,d.on,d.wO,d.nD,o.g2,o.x4,o.QI,o.t9,Z.sg,o.n0,o.YG,o.as,o.ho,o.w,o.PQ],styles:["img[_ngcontent-%COMP%]{height:10vh;width:10vh}"]}),t})()}];let B=(()=>{class t{}return t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[[T.Bz.forChild(k)],T.Bz]}),t})();var H=l(5642);let K=(()=>{class t{}return t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[[Z.ez,d.u5,o.Pc,B,H.K]]}),t})()}}]);